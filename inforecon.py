#!/usr/bin/env python3

"""Gathering Information

(1) Grabbing banners
(2) Hostname
(3) IP Lookup

Usage: $ python3 inforecon.py <url>

Arguments:
    -url <str>: url of website
"""

### Import Statements ###

import json
import socket
import sys

import requests

### Functions ###


def get_url_info(url: str) -> str:
    """Gets a list of information from a url

    Args:
        url (str): The url of a website

    Returns:
        str: The headers, ip adress, and banners of a url
    """
    try:
        # Gets headers using requests
        req = requests.get(f"https://{url}")
        print(f"\nHeaders for <{url}>:")
        for key, value in req.headers.items():
            print(f"\t{key}: {value}")

        # Gets ip address using socket
        ipaddress = socket.gethostbyname(url)
        print(f"\nIP address of <{url}>: {ipaddress}")

        # Gets api generated information
        api_req = requests.get(f"https://ipinfo.io/{ipaddress}/json")
        resp = json.loads(api_req.text)
        print(f"\tIp info for <{url}>:")
        for key, value in resp.items():
            print(f"\t{key}: {value}")
    except:
        print(f"Connection to <{url}> refused, exiting...")
        sys.exit(1)


if __name__ == "__main__":
    if len(sys.argv) < 2:
        print(f"Usage: python3 {sys.argv[0]} <url>")
        sys.exit(1)
    get_url_info(sys.argv[1])
