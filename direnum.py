#!/usr/bin/env python3

"""Directory enumeration

Discovering directories by using a list of possible entries

Usage: $ python3 direnum.py <domain> -w <wordlist>
"""

import argparse
import sys

import requests


def find_directories(target: str, wordlist: str) -> None:
    """Finds valid directories

    Args:
        target (str): URL
        wordlist (str): Path to wordlist

    Modify endings to include different extentions, "" used for subdirectories
    """
    print(f"Starting Enumeration on <{target}> using <{wordlist}>...")
    words = open(wordlist).read().splitlines()
    for word in words:
        endings = ["html"]
        for end in endings:
            attempt = ""
            if end == "":
                attempt = f"http://{target}/{word}"
            else:
                attempt = f"http://{target}/{word}.{end}"
            try:
                r = requests.get(attempt)
                if not r.status_code == 404:
                    print(f"\tValid directory: {attempt} --> {word}.{end}")
            except:
                print("Connection refused!")
                return
    print("Enumeration complete.")


if __name__ == "__main__":
    default_wordlist = "resources/subdomains.txt"
    parser = argparse.ArgumentParser(description="Find directories")
    parser.add_argument(
        "domain", help="Domain of target i.e. google.com or 10.10.10.10"
    )
    parser.add_argument(
        "-w",
        "--wordlist",
        help="Wordlist",
        default=default_wordlist,
    )
    args = parser.parse_args()
    find_directories(args.domain, args.wordlist)
